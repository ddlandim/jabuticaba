DataSplit_1 conf file loaded
running step : DataSplit_1
Exporting ../Datalake/splited/20220606144339/X_train.csv
          anos_como_pro   rel_pont    rel_pat  totals  max_camp  escalacoes  norm_rodadas  ...  log_interacoes_g1  log_tempo_desperd  log_iteracao_volei  log_iteracao_atletismo  total_pixels  ceil_avg_3  ceil_avg_4
GLOBO_ID                                                                                   ...                                                                                                                        
159304                0  -8.306303 -17.758091       0   5070031    0.486486      0.315789  ...           0.026668           5.658257            0.000000                0.000000           NaN         1.0    0.000000
152161                0  23.649489  18.693957       1   1704019   11.947368      1.000000  ...           0.456758           9.759604            0.100083                8.285719           NaN         1.0    0.973684
251693                0  12.193700  15.703694       0   2303844    5.763158      0.868421  ...           1.025853          11.346544            0.916291               11.242185           NaN         1.0    0.000000
213906                0  -1.429195  -4.964990       0   3206353    1.710526      0.578947  ...           0.000000           0.000000            0.000000                0.000000           NaN         1.0    0.000000
247350                0   9.470016  -6.163411       0   2925575    2.605263      1.000000  ...           0.439951           9.861747            0.274437                9.653644           NaN         1.0    0.000000

[5 rows x 21 columns]
run_steps fail
Traceback (most recent call last):
  File "main.py", line 55, in run
    run_steps(conf["steps"])
  File "main.py", line 31, in run_steps
    __step_obj = variables.steps_dict[__step](_step_json)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 79, in __init__
    self.dump()
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 83, in dump
    self.X_train_dh.dump(out_path)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/dataUtils/dataHandler.py", line 40, in dump
    _df.to_csv(_path)
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 3563, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/format.py", line 1180, in to_csv
    csv_formatter.save()
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/csvs.py", line 241, in save
    with get_handle(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/common.py", line 697, in get_handle
    check_parent_directory(str(handle))
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/common.py", line 571, in check_parent_directory
    raise OSError(fr"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: '../Datalake/splited/20220606144339'
DataSplit_1 conf file loaded
running step : DataSplit_1
Exporting ../Datalake/splited/20220606144837/X_train.csv
          anos_como_pro   rel_pont    rel_pat  totals  max_camp  escalacoes  norm_rodadas  ...  log_interacoes_g1  log_tempo_desperd  log_iteracao_volei  log_iteracao_atletismo  total_pixels  ceil_avg_3  ceil_avg_4
GLOBO_ID                                                                                   ...                                                                                                                        
205260                0  14.446858  33.191063       0   2318920    4.473684      0.973684  ...           0.100083           7.203366            0.100083                7.203366           NaN    1.000000    0.000000
146049                0   5.036595 -16.414464       0   4137596    1.578947      0.921053  ...           0.000000           0.000000            0.000000                0.000000           NaN    0.921053    0.000000
246003                1  14.914489  14.500273       1   1845056    3.105263      0.894737  ...           0.294239           9.494157            0.075986                8.502656           NaN    1.000000    0.868421
176721                0 -17.775706 -12.930600       0   5904845    0.305556      0.236842  ...           0.027399           5.633996            0.000000                0.000000           NaN    1.000000    0.000000
192038                3  -4.466827 -31.864727       0   3509505    2.000000      0.684211  ...           0.387766           9.594944            0.212561                9.198209           NaN    0.000000    0.000000

[5 rows x 21 columns]
run_steps fail
Traceback (most recent call last):
  File "main.py", line 55, in run
    run_steps(conf["steps"])
  File "main.py", line 31, in run_steps
    __step_obj = variables.steps_dict[__step](_step_json)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 79, in __init__
    self.dump()
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 83, in dump
    self.X_train_dh.dump(out_path)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/dataUtils/dataHandler.py", line 46, in dump
    _df.to_csv(_path)
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 3563, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/format.py", line 1180, in to_csv
    csv_formatter.save()
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/csvs.py", line 241, in save
    with get_handle(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/common.py", line 789, in get_handle
    handle = open(
IsADirectoryError: [Errno 21] Is a directory: '../Datalake/splited/20220606144837/X_train.csv'
DataSplit_1 conf file loaded
running step : DataSplit_1
Exporting ../Datalake/splited/20220606145306/X_train.csv
          anos_como_pro   rel_pont    rel_pat  totals  max_camp  escalacoes  norm_rodadas  ...  log_interacoes_g1  log_tempo_desperd  log_iteracao_volei  log_iteracao_atletismo  total_pixels  ceil_avg_3  ceil_avg_4
GLOBO_ID                                                                                   ...                                                                                                                        
230672                0  13.049752 -12.587622       0   3716571    3.315789      0.973684  ...           0.100083           8.406191            0.000000                0.000000           NaN         1.0    0.736842
151405                2  13.458700  15.341852       0   3156323    2.789474      1.000000  ...           0.313658           9.719433            0.025975                5.576547           NaN         1.0    0.526316
252118                0  -4.690511  27.018694       0   3660925    0.236842      0.210526  ...           0.100083           9.014361            0.051293                7.543956           NaN         1.0    0.000000
163830                2  14.753437  11.727642       1   2577828    1.473684      0.973684  ...           3.955284          14.813748            3.647920               14.558915           NaN         1.0    1.000000
214266                0  -1.248925  -0.922730       0   5788660    1.090909      0.368421  ...           2.397895          12.884078            1.546918               12.222290           NaN         1.0    0.000000

[5 rows x 21 columns]
run_steps fail
Traceback (most recent call last):
  File "main.py", line 55, in run
    run_steps(conf["steps"])
  File "main.py", line 31, in run_steps
    __step_obj = variables.steps_dict[__step](_step_json)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 79, in __init__
    self.dump()
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/steps/dataSplit.py", line 83, in dump
    self.X_train_dh.dump(out_path)
  File "/mnt/c/Users/douglas.diniz.landim/OneDrive - Accenture/Documents/Desafio_Eng_ML/Project/Src/dataUtils/dataHandler.py", line 48, in dump
    _df.to_csv(_path)
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 3563, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/format.py", line 1180, in to_csv
    csv_formatter.save()
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/formats/csvs.py", line 241, in save
    with get_handle(
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/common.py", line 697, in get_handle
    check_parent_directory(str(handle))
  File "/home/accenture/.local/lib/python3.8/site-packages/pandas/io/common.py", line 571, in check_parent_directory
    raise OSError(fr"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: '../Datalake/splited/20220606145306'
DataSplit_1 conf file loaded
running step : DataSplit_1
Exporting ../Datalake/splited/20220606145932/X_train.csv
          anos_como_pro   rel_pont    rel_pat  totals  max_camp  escalacoes  norm_rodadas  ...  log_interacoes_g1  log_tempo_desperd  log_iteracao_volei  log_iteracao_atletismo  total_pixels  ceil_avg_3  ceil_avg_4
GLOBO_ID                                                                                   ...                                                                                                                        
149045                3  19.236595  30.546326       0   1201723    7.684211      1.000000  ...           0.937125          11.066454            0.596520               10.578798           NaN    1.000000    0.342105
208665                0  21.997384  24.066326       0   3480788    3.447368      1.000000  ...           0.000000           0.000000            0.000000                0.000000           NaN    1.000000    0.000000
127878                0  14.427121  23.673957       0   3339446    2.447368      0.947368  ...           0.625094          10.745919            0.422857               10.277822           NaN    1.000000    0.131579
129658                2  22.687384  38.331589       1   1466171    1.921053      0.921053  ...           2.808134          13.588927            2.633402               13.404651           NaN    1.000000    0.763158
167860                0   4.924489 -10.515253       0   3273027    3.210526      0.973684  ...           0.051293           7.875719            0.025975                7.652671     2304720.0    0.526316    0.000000

[5 rows x 21 columns]
Exporting ../Datalake/splited/20220606145932/X_test.csv
          anos_como_pro   rel_pont    rel_pat  totals  max_camp  escalacoes  norm_rodadas  ...  log_interacoes_g1  log_tempo_desperd  log_iteracao_volei  log_iteracao_atletismo  total_pixels  ceil_avg_3  ceil_avg_4
GLOBO_ID                                                                                   ...                                                                                                                        
134149                0  19.909489  23.385799       0   2518919    8.815789      1.000000  ...           1.462280          11.797932            0.422857               10.285719           NaN    1.000000    0.105263
166980                0   7.141331  -7.283674       0   4529539    2.000000      0.921053  ...           0.000000           0.000000            0.000000                0.000000      995040.0    1.000000    0.105263
246282                2  19.243173  14.258168       0   2296030    3.868421      1.000000  ...           1.549800          12.032123            0.937125               11.533781     2301480.0    1.000000    0.000000
160851                3  17.352647  39.819747       0   3220525    4.815789      1.000000  ...           1.532898          13.044763            1.149906               12.876805      921600.0    1.000000    1.000000
212390                0  28.126483  17.965609       0   6519407   20.954545      0.578947  ...           1.524078          11.621638            0.737599               10.521052           NaN    0.909091    0.000000

[5 rows x 21 columns]
Exporting ../Datalake/splited/20220606145932/y_train.csv
          pro_target
GLOBO_ID            
149045             1
208665             0
127878             1
129658             1
167860             1
Exporting ../Datalake/splited/20220606145932/y_test.csv
          pro_target
GLOBO_ID            
134149             1
166980             0
246282             1
160851             1
212390             0
